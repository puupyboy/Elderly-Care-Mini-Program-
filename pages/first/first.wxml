<view class="container">
  <!-- åŠ è½½ä¸­ -->
  <view class="loading-wrap" wx:if="{{loading && !loadError}}">
    <view class="loading-spinner"></view>
    <text>æ­£åœ¨åŠ è½½...</text>
  </view>

  <!-- åŠ è½½å¤±è´¥ -->
  <view class="error-wrap" wx:elif="{{loadError}}">
    <text class="error-icon">ğŸ˜•</text>
    <text class="error-text">åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ</text>
    <button class="retry-btn" bindtap="retryLoad">é‡æ–°åŠ è½½</button>
  </view>

  <block wx:else>
  <view class="header">
    <view>
      <text class="title">æ—©å®‰ï¼Œæçˆ·çˆ·</text>
      <text class="subtitle">ä»Šå¤©ä¹Ÿæ˜¯ç¾å¥½çš„ä¸€å¤©</text>
    </view>
    <view class="weather">
      <text class="temp">24Â°C</text>
      <text class="weather-desc">å¤šäº‘ å¾®é£</text>
    </view>
  </view>

  <view class="card">
    <view class="card-header">
      <text class="icon-red">â¤ï¸</text>
      <text class="card-title">å¥åº·ç®¡ç†</text>
    </view>
    <view class="grid-2">
      <view class="status-item bg-red">
        <view class="icon-circle"><text>ğŸ’Š</text></view>
        <text class="status-label">åƒè¯æé†’</text>
        <text class="status-val">ä¸Šåˆ 08:00 (å·²æœ)</text>
      </view>
      <view class="status-item bg-blue">
        <view class="icon-circle"><text>ğŸ“Š</text></view>
        <text class="status-label">è¡€å‹å¿ƒç‡</text>
        <text class="status-val">128/82 mmHg</text>
      </view>
    </view>
  </view>

  <view class="card">
    <view class="card-header-flex">
      <view class="flex-row">
        <text class="icon-warm">ğŸ‘¥</text>
        <text class="card-title">å¿—æ„¿è€…é™ªä¼´</text>
      </view>
      <text class="more">æŸ¥çœ‹å…¨éƒ¨ ></text>
    </view>
    <scroll-view scroll-x class="volunteer-scroll">
      <view class="volunteer-item" wx:for="{{volunteers}}" wx:key="_id" bindtap="openVolunteer" data-item="{{item}}">
        <view class="avatar-wrap">
          <image src="{{item.avatar}}" class="avatar"></image>
          <text class="check-icon" wx:if="{{item.applied}}">âœ…</text>
        </view>
        <text class="v-name">{{item.name}}</text>
        <text class="v-skill">{{item.skill}}</text>
        <view class="v-tag {{item.applied ? 'tag-green' : 'tag-warm'}}">
          {{item.applied ? 'å·²ç”³è¯·' : 'ç”³è¯·'}}
        </view>
      </view>
    </scroll-view>
  </view>

  <view class="card">
    <view class="card-header">
      <text class="icon-green">ğŸ¥—</text>
      <text class="card-title">å…»ç”Ÿä¸é¥®é£Ÿ</text>
    </view>
    <view class="video-box">
      <image src="https://picsum.photos/800/450?random=10" class="video-cover"></image>
      <view class="play-btn">â–¶ï¸</view>
      <view class="video-info">
        <text>ä»Šæ—¥æ¨èï¼šç§‹å­£æ¶¦è‚ºæ­¢å’³æ±¤çš„åšæ³•</text>
      </view>
    </view>
  </view>

  <view class="card">
    <view class="card-header">
      <text class="icon-purple">ğŸšš</text>
      <text class="card-title">ç”Ÿæ´»æœåŠ¡</text>
    </view>
    <view class="grid-3">
      <view class="service-btn" wx:for="{{services}}" wx:key="label">
        <view class="service-icon {{item.color}}">{{item.icon}}</view>
        <text>{{item.label}}</text>
      </view>
    </view>
  </view>
  </block>

  <view class="modal-mask" wx:if="{{selectedVolunteer}}" bindtap="closeVolunteer">
    <view class="modal-content" catchtap="stopBubble">
      <image src="{{selectedVolunteer.avatar}}" class="modal-avatar"></image>
      <text class="modal-name">{{selectedVolunteer.name}}</text>
      <view class="modal-intro">
        <text class="intro-title">ä¸ªäººä»‹ç»</text>
        <text class="intro-text">{{selectedVolunteer.bio}}</text>
      </view>
      <button class="modal-apply {{selectedVolunteer.applied ? 'btn-disabled' : ''}}" 
              bindtap="handleApply" data-id="{{selectedVolunteer._id || selectedVolunteer.id}}">
        {{selectedVolunteer.applied ? 'å·²ç”³è¯·' : 'ç‚¹å‡»ç”³è¯·'}}
      </button>
    </view>
  </view>
</view>